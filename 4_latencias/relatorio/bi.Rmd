---
output:
  html_document:                    # Classe de documento.
    toc: true                       # Exibir sum?rio.
    toc_depth: 2                    # Profundidade do sum?rio.
    toc_float:                      # Sum?rio flutuante na borda.
      collapsed: true
      smooth_scroll: true
    number_sections: false           # Se??es numeradas.
    theme: cosmo
    #spacelab
    #default,cerulean,journal,flatly,readable,spacelab,
    #united,cosmo,lumen,paper,sandstone,simplex,yeti
    
    highlight: espresso
    #default, tango, pygments, kate, monochrome, espresso, zenburn, haddock, and textmate
    #css: styles.css                 # Caminho para arquivo CSS.
    fig_width: 7                    # Lagura das figuras.
    fig_height: 6                   # Altura das figuras.
    fig_caption: true               # Exibica??o de legenda.
    fig_align: 'center'
    code_folding: hide              # Esconder/exibir bloco de c?digo.
#    keep_md: true                   # Manter o arquivo md.
    #template: quarterly_report.html # Caminho para o template.  
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, cache = FALSE,fig.align='center', fig.width=5, fig.height=5)

#--------------------------------------------------------------
setwd("~/msc/4_latencias")
#--------------------------------------------------------------

library(tidyverse)
library(gridExtra)
library(ggpubr)

source('funcoes.R')

#--------------------------------------------------------------

# DADOS
#--------------------------------------------------------------

dados <- read.csv2('tissei.csv', header = T, sep = ',')

str(dados)

names(dados) <- c('n', 'inst', 'lock', 'set_rex', 'segment',
                  'mem_xchg', 'p0156', 'p06', 'p23', 'p237', 
                  'p4', 'p1', 'p15', 'p015', 'p5', 'p0', 
                  'p05', 'p01', 'p6', 'min_lat', 'max_lat')



```

---

<center>
<font size="6"> 
<p align=”center”> <b> Análise gráfica bivariada </b> </center>
</font>
</center>

---

<center>
<font size="6"> 
<p align=”center”> <b> Dados completos </b> </center>
</font>
</center>

---

# Latência em função das indicadoras e segment

---

## Latência mínima {.tabset .tabset-fade}

---

### lock

<center>
```{r, echo=FALSE}
pander::pander(data.frame(Níveis = c(0,1),
           Média = c(round(tapply(dados$min_lat, dados$lock, mean)[1], 3),
                     round(tapply(dados$min_lat, dados$lock, mean)[2], 3)),
           Desv_pad = c(round(tapply(dados$min_lat, dados$lock, sd)[1], 3),
                     round(tapply(dados$min_lat, dados$lock, sd)[2], 3)))
)

```
</center>

---

### set_rex

<center>
```{r, echo=FALSE, fig.width=5, fig.height=5}
pander::pander(data.frame(Níveis = c(0,1),
           Média = c(round(tapply(dados$min_lat, dados$set_rex, mean)[1], 3),
                     round(tapply(dados$min_lat, dados$set_rex, mean)[2], 3)),
           Desv_pad = c(round(tapply(dados$min_lat, dados$set_rex, sd)[1], 3),
                     round(tapply(dados$min_lat, dados$set_rex, sd)[2], 3)))
)
```
</center>

---

### mem_xchg

<center>
```{r, echo=FALSE, fig.width=5, fig.height=5}
pander::pander(data.frame(Níveis = c(0,1),
           Média = c(round(tapply(dados$min_lat, dados$mem_xchg, mean)[1], 3),
                     round(tapply(dados$min_lat, dados$mem_xchg, mean)[2], 3)),
           Desv_pad = c(round(tapply(dados$min_lat, dados$mem_xchg, sd)[1], 3),
                     round(tapply(dados$min_lat, dados$mem_xchg, sd)[2], 3)))
)
```
</center>

---

### segment

<center>
```{r, echo=FALSE, fig.width=5, fig.height=5}
seg <- factor(dados$segment, levels = 0:6)

pander::pander(data.frame(Níveis = 0:6,
                          Média = c(round(tapply(dados$min_lat, seg, mean)[1], 3),
                                    round(tapply(dados$min_lat, seg, mean)[2], 3),
                                    round(tapply(dados$min_lat, seg, mean)[3], 3),
                                    round(tapply(dados$min_lat, seg, mean)[4], 3),
                                    round(tapply(dados$min_lat, seg, mean)[5], 3),
                                    round(tapply(dados$min_lat, seg, mean)[6], 3),
                                    round(tapply(dados$min_lat, seg, mean)[7], 3)),
                          
                          Desv_pad = c(round(tapply(dados$min_lat, seg, sd)[1], 3),
                                       round(tapply(dados$min_lat, seg, sd)[2], 3),
                                       round(tapply(dados$min_lat, seg, sd)[3], 3),
                                       round(tapply(dados$min_lat, seg, sd)[4], 3),
                                       round(tapply(dados$min_lat, seg, sd)[5], 3),
                                       round(tapply(dados$min_lat, seg, sd)[6], 3),
                                       round(tapply(dados$min_lat, seg, sd)[7], 3)))
)

```
</center>

## Latência máxima {.tabset .tabset-fade}

### lock

<center>
```{r, echo=FALSE}
pander::pander(data.frame(Níveis = c(0,1),
           Média = c(round(tapply(dados$max_lat, dados$lock, mean)[1], 3),
                     round(tapply(dados$max_lat, dados$lock, mean)[2], 3)),
           Desv_pad = c(round(tapply(dados$max_lat, dados$lock, sd)[1], 3),
                     round(tapply(dados$max_lat, dados$lock, sd)[2], 3)))
)

```
</center>

---

### set_rex

<center>
```{r, echo=FALSE, fig.width=5, fig.height=5}
pander::pander(data.frame(Níveis = c(0,1),
           Média = c(round(tapply(dados$max_lat, dados$set_rex, mean)[1], 3),
                     round(tapply(dados$max_lat, dados$set_rex, mean)[2], 3)),
           Desv_pad = c(round(tapply(dados$max_lat, dados$set_rex, sd)[1], 3),
                     round(tapply(dados$max_lat, dados$set_rex, sd)[2], 3)))
)
```
</center>

---

### mem_xchg

<center>
```{r, echo=FALSE, fig.width=5, fig.height=5}
pander::pander(data.frame(Níveis = c(0,1),
           Média = c(round(tapply(dados$max_lat, dados$mem_xchg, mean)[1], 3),
                     round(tapply(dados$max_lat, dados$mem_xchg, mean)[2], 3)),
           Desv_pad = c(round(tapply(dados$max_lat, dados$mem_xchg, sd)[1], 3),
                     round(tapply(dados$max_lat, dados$mem_xchg, sd)[2], 3)))
)
```
</center>

---

### segment

<center>
```{r, echo=FALSE, fig.width=5, fig.height=5}
seg <- factor(dados$segment, levels = 0:6)

pander::pander(data.frame(Níveis = 0:6,
                          Média = c(round(tapply(dados$max_lat, seg, mean)[1], 3),
                                    round(tapply(dados$max_lat, seg, mean)[2], 3),
                                    round(tapply(dados$max_lat, seg, mean)[3], 3),
                                    round(tapply(dados$max_lat, seg, mean)[4], 3),
                                    round(tapply(dados$max_lat, seg, mean)[5], 3),
                                    round(tapply(dados$max_lat, seg, mean)[6], 3),
                                    round(tapply(dados$max_lat, seg, mean)[7], 3)),
                          
                          Desv_pad = c(round(tapply(dados$max_lat, seg, sd)[1], 3),
                                       round(tapply(dados$max_lat, seg, sd)[2], 3),
                                       round(tapply(dados$max_lat, seg, sd)[3], 3),
                                       round(tapply(dados$max_lat, seg, sd)[4], 3),
                                       round(tapply(dados$max_lat, seg, sd)[5], 3),
                                       round(tapply(dados$max_lat, seg, sd)[6], 3),
                                       round(tapply(dados$max_lat, seg, sd)[7], 3)))
)

```
</center>

---

# Gráficos {.tabset .tabset-fade}

---

## Latência mínima 

<center>
```{r, echo=FALSE, fig.width=8, fig.height=5, warning=FALSE}
g1 <-ggplot(data = dados,
       aes(x = factor(lock),
           y = min_lat)) + geom_boxplot() +
  xlab('lock') + ylab('Latência mínima') + theme_bw()

g2 <-ggplot(data = dados,
       aes(x = factor(set_rex),
           y = min_lat)) + geom_boxplot() +
  xlab('set_rex') + ylab('Latência mínima') + theme_bw()

g3 <-ggplot(data = dados,
       aes(x = factor(mem_xchg),
           y = min_lat)) + geom_boxplot() +
  xlab('mem_xchg') + ylab('Latência mínima') + theme_bw()

g4 <-ggplot(data = dados,
       aes(x = factor(segment),
           y = min_lat)) + geom_boxplot() +
  xlab('segment') + ylab('Latência mínima') + theme_bw()

ggarrange(g1,g2,g3,g4,
          nrow = 2, ncol = 2)


```
</center>

---

## Latência máxima

<center>
```{r, echo=FALSE, fig.width=8, fig.height=5, warning=FALSE}
g1 <-ggplot(data = dados,
            aes(x = factor(lock),
                y = max_lat)) + geom_boxplot() +
  xlab('lock') + ylab('Latência máxima') + theme_bw()

g2 <-ggplot(data = dados,
            aes(x = factor(set_rex),
                y = max_lat)) + geom_boxplot() +
  xlab('set_rex') + ylab('Latência máxima') + theme_bw()

g3 <-ggplot(data = dados,
            aes(x = factor(mem_xchg),
                y = max_lat)) + geom_boxplot() +
  xlab('mem_xchg') + ylab('Latência máxima') + theme_bw()

g4 <-ggplot(data = dados,
            aes(x = factor(segment),
                y = max_lat)) + geom_boxplot() +
  xlab('segment') + ylab('Latência máxima') + theme_bw()

ggarrange(g1,g2,g3,g4,
          nrow = 2, ncol = 2)

```
</center>

---

## Latência mínima (log)

<center>
```{r, echo=FALSE, fig.width=8, fig.height=5, warning=FALSE}
g1 <-ggplot(data = dados,
            aes(x = factor(lock),
                y = log(min_lat))) + geom_boxplot() +
  xlab('lock') + ylab('Latência mínima') + theme_bw()

g2 <-ggplot(data = dados,
            aes(x = factor(set_rex),
                y = log(min_lat))) + geom_boxplot() +
  xlab('set_rex') + ylab('Latência mínima') + theme_bw()

g3 <-ggplot(data = dados,
            aes(x = factor(mem_xchg),
                y = log(min_lat))) + geom_boxplot() +
  xlab('mem_xchg') + ylab('Latência mínima') + theme_bw()

g4 <-ggplot(data = dados,
            aes(x = factor(segment),
                y = log(min_lat))) + geom_boxplot() +
  xlab('segment') + ylab('Latência mínima') + theme_bw()

ggarrange(g1,g2,g3,g4,
          nrow = 2, ncol = 2)

```
</center>

---

## Latência máxima (log)

```{r, echo=FALSE, fig.width=8, fig.height=5, warning=FALSE}

g1 <-ggplot(data = dados,
            aes(x = factor(lock),
                y = log(max_lat))) + geom_boxplot() +
  xlab('lock') + ylab('Latência máxima') + theme_bw()

g2 <-ggplot(data = dados,
            aes(x = factor(set_rex),
                y = log(max_lat))) + geom_boxplot() +
  xlab('set_rex') + ylab('Latência máxima') + theme_bw()

g3 <-ggplot(data = na.omit(dados),
            aes(x = factor(mem_xchg),
                y = log(max_lat))) + geom_boxplot() +
  xlab('mem_xchg') + ylab('Latência máxima') + theme_bw()

g4 <-ggplot(data = dados,
            aes(x = factor(segment),
                y = log(max_lat))) + geom_boxplot() +
  xlab('segment') + ylab('Latência máxima') + theme_bw()

ggarrange(g1,g2,g3,g4,
          nrow = 2, ncol = 2)

```

---

# Latência em função das portas {.tabset .tabset-fade}

---

## p0156

<center>
```{r,echo=FALSE,fig.width=10, fig.height=4}
scat('p0156')


```
</center>

---

## p06

<center>
```{r,echo=FALSE,fig.width=10, fig.height=4}
scat('p06')


```
</center>

---

## p23

<center>
```{r,echo=FALSE,fig.width=10, fig.height=4}
scat('p23')


```
</center>

---

## p237

<center>
```{r,echo=FALSE,fig.width=10, fig.height=4}
scat('p237')


```
</center>

---

## p4

<center>
```{r,echo=FALSE,fig.width=10, fig.height=4}
scat('p4')


```
</center>

---

## p1

<center>
```{r,echo=FALSE,fig.width=10, fig.height=4}
scat('p1')


```
</center>

---

## p15

<center>
```{r,echo=FALSE,fig.width=10, fig.height=4}
scat('p15')


```
</center>

---

## p015

<center>
```{r,echo=FALSE,fig.width=10, fig.height=4}
scat('p015')


```
</center>

---

## p5

<center>
```{r,echo=FALSE,fig.width=10, fig.height=4}
scat('p5')


```
</center>

---

## p0

<center>
```{r,echo=FALSE,fig.width=10, fig.height=4}
scat('p0')


```
</center>

---

## p05

<center>
```{r,echo=FALSE,fig.width=10, fig.height=4}
scat('p05')


```
</center>

---

## p01

<center>
```{r,echo=FALSE,fig.width=10, fig.height=4}
scat('p01')


```
</center>

---

## p6

<center>
```{r,echo=FALSE,fig.width=10, fig.height=4}
scat('p6')


```
</center>

---

# Correlograma

<center>
```{r,echo=FALSE,fig.width=7, fig.height=7}
numericas <- dados[,c(7:18,20,21)]

names(numericas)[c(13,14)] <- c('min', 'max')

cor1 <- cor(numericas, method = 'pearson')

corrplot::corrplot.mixed(cor1, 
                         upper = 'ellipse',
                         tl.pos = "d"#,
                         #diag = 'n'
                         )

```
</center>

---

<div class="tocify-extend-page" data-unique="tocify-extend-page" style="height: 0;"></div>