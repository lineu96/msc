---
output:
  html_document: 
    type: inverse
    # Sumário
    toc: true 
    toc_depth: 3 # Profundidade do sumário                   
    toc_float:                      
      collapsed: true # Sumário flutuante (lateral)
    
#    number_sections: true # Seções numeradas
    
    # Aparência
    theme: flatly
    # Temas possíveis:
    # default,cerulean,journal,flatly,readable,spacelab,
    # united,cosmo,lumen,paper,sandstone,simplex,yeti
    
    # Códigos R no texto
#    highlight: espresso
    # Temas possíveis:
    # default, tango, pygments, kate, monochrome, 
    # espresso, zenburn, haddock, and textmate
    #css: styles.css                
    
    # Configurações globais de imagens
    fig_width: 7  # Largura                  
    fig_height: 6 # Altura                  
    fig_caption: true # Legenda              
    fig_align: 'center' # Posição

    # Esconder o código
#    code_folding: hide 
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

---

<center>
<font size="6"> 
<p align=”center”> <b> Análise de variância multivariada via teste Wald </b> </center>
</font>
</center>

---

<font size="4"> 
<p align=”center”> [Lineu Alberto Cavazani de Freitas](https://lineu96.github.io/st/) </center>
</font> 

---

A MANOVA clássica \cite{manova} é um assunto com vasta discussão na
literatura e possui diversas propostas com o objetivo de
verificar a nulidade conjunta dos parâmetros de um modelo de regressão 
multivariado, como os já citados, lambda de Wilk's \cite{wilks}, traço 
de Hotelling-Lawley \cite{lawley, hotelling}, traço de Pillai
\cite{pillai} e maior raiz de Roy \cite{roy}. 

Nesta seção, será apresentado uma extensão do clássico teste de Wald para 
lidar com múltiplas respostas não gaussianas e de diferentes naturezas.
Sendo assim, seguindo a \autoref{eq:mcglm} que descreve a média e a matriz de 
variância e covariância conjunta de um MCGLM, pode-se enunciar as
hipóteses de interesse como
\begin{equation}
\label{eq:hipotese}
\begin{aligned}
H_0 &= \boldsymbol{L}\boldsymbol{\beta} = \boldsymbol{0}
\\
H_1 &= \boldsymbol{L}\boldsymbol{\beta} = \boldsymbol{c} ,
\end{aligned}
\end{equation}
\noindent em que, na hipótese nula, $\boldsymbol{L}$ = $\boldsymbol{G} \otimes \boldsymbol{F}$. A matriz $\boldsymbol{G}$ tem dimensão
$R\times R$ e especifica as hipóteses referentes às respostas, enquanto
que a matriz $\boldsymbol{F}$, a qual especifica as hipóteses entre
tratamentos, tem  dimensão $s\times p$, onde $s$ é o número de restrições 
lineares e $p$ é o número de coeficientes de regressão para cada variável 
resposta. Sendo assim, a matriz $\boldsymbol{L}$ tem dimensão
($sR\times p$). E na hipótese alternativa, $\boldsymbol{c}$ é um vetor 
qualquer não nulo.

Para avaliar a hipótese linear especificada na \autoref{eq:hipotese},
fez-se uso da estatística de Wald representada por
\begin{equation}
\label{eq:wald}
W_{s} = \left ( \boldsymbol{L\beta} \right )^T\left ( \boldsymbol{L}J_{\boldsymbol{\beta}}^{-1} \boldsymbol{L}^T \right )^{-1}\left ( \boldsymbol{L\beta} \right ),
\end{equation}
\noindent em que $J_{\boldsymbol{\beta}}^{-1}$ é a parte da inversa da matriz de informação de Godambe que considera apenas os parâmetros de regressão. Sob a hipótese nula, a estatística segue assintoticamente distribuição
Qui-quadrado com $sR$ graus de liberdade. É possível notar que essa 
construção permite realizar o teste de hipóteses para todas as variáveis 
respostas, bem como entre combinações de variáveis e todos os possíveis 
contrastes entre os níveis de tratamento.

Para exemplificar a flexibilidade do método, considere um caso com duas variáveis respostas e uma variável explicativa $X$ categórica com três níveis (A, B e C). Neste caso, o preditor linear é dado por
$$
\mu_r = \beta_{r0} + \beta_{r1}\left [ X = B \right ] + \beta_{r2}\left [ X = C \right ],
$$
\noindent em que $\beta_{r0}$ é o intercepto e $\beta_{r1}$ e $\beta_{r2}$ representam a diferença do tratamento $A$ para $B$ e $A$ para $C$,
respectivamente. Nesta parametrização, em que A é a categoria de referência, a matriz de delineamento tem a
forma
$$
D = \begin{pmatrix}
 1     &  \cdot &  \cdot & \cdot &  \cdot & \cdot \\ 
 1     &  1     &  \cdot & \cdot &  \cdot & \cdot \\ 
 1     &  \cdot &  1     & \cdot &  \cdot & \cdot \\ 
 \cdot &  \cdot &  \cdot &  1    &  \cdot & \cdot \\ 
 \cdot &  \cdot &  \cdot &  1    &  1     & \cdot \\ 
 \cdot &  \cdot &  \cdot &  1    &  \cdot & 1
\end{pmatrix}.
$$

A hipótese nula do teste pode ser escrita como
$$
H_0 = \beta_{r1} = \beta_{r2} = 0, \text{  para  } r = 1, 2,
$$

\noindent o que equivale, em notação matricial a
$$
H_0: \begin{pmatrix}
 1 &  0 & 0 & 0 \\ 
 0 &  1 & 0 & 0 \\ 
 0 &  0 & 1 & 0 \\ 
 0 &  0 & 0 & 1
\end{pmatrix}
\begin{pmatrix}
\beta_{11} \\ 
\beta_{12} \\ 
\beta_{21} \\ 
\beta_{22}
\end{pmatrix}
=
\begin{pmatrix}
0 \\ 
0 \\ 
0 \\ 
0
\end{pmatrix},
$$
\noindent de forma que
$$
\boldsymbol{G} = \begin{pmatrix}
 1 & 0 \\ 
 0 & 1
\end{pmatrix}
\text{  e  }
\boldsymbol{F} =\begin{pmatrix}
 1 & 0 \\ 
 0 & 1
\end{pmatrix}.
$$

Com isso, calcula-se as estatísticas de Wald seguindo a \autoref{eq:wald} e realiza-se a interpretação do teste. É importante ressaltar que, embora a matriz de variância e covariância $\boldsymbol{\Sigma}$ não apareça explicitamente nas estatísticas de Wald, ela tem um impacto crucial, pois a matriz de informação de Godambe ($J_{\boldsymbol{\theta}}$) depende dela. Consequentemente, o teste apresentado tem a MANOVA clássica como um caso particular.

---

<center>
<table><tr>
<td> <img src="img/dsbd.png" alt="Drawing" style="width: 250px;"/> </td>
<td> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </td>
<td> <img src="img/ufpr.jpg" alt="Drawing" style="width: 200px;"/> </td>
<td> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </td>
</center>


<div class="tocify-extend-page" data-unique="tocify-extend-page" style="height: 0;"></div>

